.vhs-filter {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 9998;
  mix-blend-mode: screen;
}

/* Scan lines overlay */
.vhs-scanlines {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.08) 2px,
    rgba(0, 0, 0, 0.08) 4px
  );
  animation: scanlines-scroll 0.08s linear infinite;
  opacity: calc(0.5 * var(--intensity, 1));
}

@keyframes scanlines-scroll {
  from { transform: translateY(0); }
  to { transform: translateY(4px); }
}

/* RGB chromatic aberration */
.vhs-rgb-shift {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    linear-gradient(90deg, 
      rgba(255, 0, 0, 0.02) 0%, 
      transparent 3%, 
      transparent 97%, 
      rgba(0, 255, 255, 0.02) 100%
    );
  animation: rgb-shift 8s ease-in-out infinite;
  opacity: calc(0.8 * var(--intensity, 1));
}

@keyframes rgb-shift {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  50% { transform: translateX(0); }
  75% { transform: translateX(2px); }
}

/* Static noise */
.vhs-noise {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity: calc(0.03 * var(--intensity, 1));
  animation: noise-animate 0.1s infinite;
}

@keyframes noise-animate {
  0% { transform: translate(0, 0); }
  10% { transform: translate(-1%, -1%); }
  20% { transform: translate(1%, 0); }
  30% { transform: translate(0, 1%); }
  40% { transform: translate(-1%, 1%); }
  50% { transform: translate(1%, -1%); }
  60% { transform: translate(-1%, 0); }
  70% { transform: translate(0, -1%); }
  80% { transform: translate(1%, 1%); }
  90% { transform: translate(-1%, -1%); }
  100% { transform: translate(0, 0); }
}

/* VHS tracking lines */
.vhs-tracking {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
}

.tracking-line {
  position: absolute;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(255, 255, 255, 0.1) 20%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.1) 80%,
    transparent 100%
  );
  animation: tracking-move 12s linear infinite;
  opacity: calc(0.4 * var(--intensity, 1));
}

.tracking-line.line-1 { animation-delay: 0s; }
.tracking-line.line-2 { animation-delay: 4s; }
.tracking-line.line-3 { animation-delay: 8s; }

@keyframes tracking-move {
  0% { top: -10px; }
  100% { top: 110%; }
}

/* Vignette effect */
.vhs-vignette {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(ellipse at center,
    transparent 50%,
    rgba(0, 0, 0, 0.3) 100%
  );
  opacity: calc(0.6 * var(--intensity, 1));
}

/* Color bleed - warm tint */
.vhs-color-bleed {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(180deg,
    rgba(100, 50, 50, 0.02) 0%,
    transparent 30%,
    transparent 70%,
    rgba(50, 50, 100, 0.02) 100%
  );
  opacity: calc(0.5 * var(--intensity, 1));
}

/* Glitch bars */
.vhs-glitch-container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
}

.glitch-bar {
  position: absolute;
  left: 0;
  width: 100%;
  height: 2px;
  background: rgba(255, 255, 255, 0.1);
  opacity: 0;
  animation: glitch-appear 15s infinite;
}

@keyframes glitch-appear {
  0%, 95%, 100% { 
    opacity: 0;
    transform: translateX(0);
  }
  96% { 
    opacity: 0.5;
    transform: translateX(-5px);
  }
  97% { 
    opacity: 0.8;
    transform: translateX(10px);
  }
  98% { 
    opacity: 0.3;
    transform: translateX(-3px);
  }
}

/* Upside Down mode - more intense */
.vhs-filter.upside-down-mode .vhs-scanlines {
  opacity: calc(0.7 * var(--intensity, 1));
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(50, 0, 50, 0.1) 2px,
    rgba(50, 0, 50, 0.1) 4px
  );
}

.vhs-filter.upside-down-mode .vhs-rgb-shift {
  background: 
    linear-gradient(90deg, 
      rgba(255, 0, 100, 0.03) 0%, 
      transparent 5%, 
      transparent 95%, 
      rgba(100, 0, 255, 0.03) 100%
    );
  animation: rgb-shift-intense 4s ease-in-out infinite;
}

@keyframes rgb-shift-intense {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  50% { transform: translateX(0); }
  75% { transform: translateX(4px); }
}

.vhs-filter.upside-down-mode .vhs-noise {
  opacity: calc(0.05 * var(--intensity, 1));
}

.vhs-filter.upside-down-mode .vhs-color-bleed {
  background: linear-gradient(180deg,
    rgba(100, 30, 80, 0.04) 0%,
    transparent 30%,
    transparent 70%,
    rgba(30, 30, 100, 0.04) 100%
  );
}

/* Mobile - reduce effects for performance */
@media (max-width: 768px) {
  .vhs-noise {
    display: none;
  }
  
  .vhs-tracking {
    display: none;
  }
  
  .vhs-glitch-container {
    display: none;
  }
}
